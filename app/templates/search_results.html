{% extends 'base.html' %}

{% block title %}
   {{ query | e | capitalize }} için Arama Sonuçları
{% endblock %}

{% block content %}
    <h1>{{ query | e | capitalize }} için arama sonuçları</h1>

    {% if results.total > 0 %}
        {% for post in results.items %}
            <article class="post">
                <h1>{{ post.title }}</h1>
                <small>{{ post.created_at | format_turkish_date }}</small>
                <div class="post-content">
                    {% if post.first_image %}
                        <img src="{{ post.first_image }}" alt="{{ post.title }}">
                    {% endif %}
                        <p>{{ post.excerpt }}</p>
                        <a href="{{ url_for('main.show_post', id=post.id) }}" class="btn">DEVAMI ➞</a>
            </div>
        </article>
        {% endfor %}
    {% else %}
        <h1 style="text-align: center;">Aramanıza uygun sonuç bulunamadı.</h1>
    {% endif %}

    <!-- Sayfalama Mantığı -->
    <div class="pagination">
    {% if results.has_prev %}
        <a href="{{ url_for('main.search', q=query, page=results.prev_num) }}">« Önceki</a>
    {% endif %}

    {% for page_num in results.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
        {% if page_num %}
            {% if page_num == results.page %}
                <span class="current-page">{{ page_num }}</span>
            {% else %}
                <a href="{{ url_for('main.search', q=query, page=page_num) }}">{{ page_num }}</a>
            {% endif %}
        {% else %}
            ...
        {% endif %}
    {% endfor %}

    {% if results.has_next %}
        <a href="{{ url_for('main.search', q=query, page=results.next_num) }}">Sonraki »</a>
    {% endif %}
</div>

    
{% endblock %}